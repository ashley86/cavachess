{% extends 'layout.html.twig' %}
{% block stylesheets %}
    {{ parent() }}
    <style>
        #competitions-list .panel-heading { padding:0;}
        #competitions-list .panel-heading a {text-decoration:none;}
        #competitions-list .panel-title { padding:10px 15px; }
        #competitions-list .ranking {background-color:white;}
    </style>
{% endblock %}


{% block page_title %}
    <h1>
        Jouer
    </h1>
{% endblock %}

{% block content %}
{#    {{dump(competitions)}}
    {{dump(rankings)}}#}
    <hr>
    <div class="row">
        <div class="col-sm-3 col-sm-push-9">
            <aside>blabla</aside>
        </div>
        <div class="col-sm-9 col-sm-pull-3">
            <section id="competitions-list">
                <div class="row">
                    {% for competition in competitions %}
                        {% set rank = 0 %}
                        <div class="col-sm-6">
                            <div class="panel panel-default">
                                <div class="panel-heading" role="tab" id="heading{{competition.id}}">
                                    <h4 class="panel-title comp-name text-center text-uppercase">{{competition.name}}</h4>
                                    <p class="panel-title play text-center"><strong><a href="{{path('app_game_displaygame', {'competition' : competition.id})}}" title="">Rejoindre</a></strong></p>
                                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapse{{competition.id}}" aria-expanded="false" aria-controls="collapse{{competition.id}}">
                                        <p class="panel-title ranking text-center">Top 10</p>
                                    </a>
                                    {#<p>Rejoindre</p>#}
                                </div>
                                <div id="collapse{{competition.id}}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading{{competition.id}}">
                                    <div class="panel-body">
                                        <table class="table table-striped table-hover">
                                            <thead>
                                                <tr>           
                                                    <th>Rang</th>  
                                                    <th>Joueur</th>
                                                    <th>Points</th>
                                                </tr>
                                            </thead>
                                                {% for ranking in rankings %}                                
                                                    {% if ranking.competition_id.id ==  competition.id %} 
                                                        {% set rank = rank + 1 %}
                                                        {% if rank < 11 %}
                                                        <tr>
                                                            <td>{{rank}}</td>
                                                            <td>{{ranking.user_id.username}}</td>
                                                            <td>{{ranking.points}}</td>
                                                        </tr>
                                                        {% endif %}
                                                    {% endif %}                                              
                                                {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% if loop.index is divisible by(2) %}
                        </div>
                        <div class="row">
                        {% endif %}                    
                    {% endfor %}
                </div>
            </section>
        </div>
    </div>
        
        
{# 
                        <a href="{{path('app_competition_displaycompetitions', {'sort' : 'ASC', 'orderby' : 'id'})}}" title="">ASC</a>
                        <a href="{{path('app_competition_displaycompetitions', {'sort' : 'DESC', 'orderby' : 'id'})}}" title="">DESC</a>

                        <a href="{{path('app_competition_displaycompetitions', {'sort' : 'ASC', 'orderby' : 'name'})}}" title="">ASC</a>
                        <a href="{{path('app_competition_displaycompetitions', {'sort' : 'DESC', 'orderby' : 'name'})}}" title="">DESC</a>                        

                        <a href="{{path('app_competition_displaycompetitions', {'sort' : 'ASC', 'orderby' : 'gamemode'})}}" title="">ASC</a>
                        <a href="{{path('app_competition_displaycompetitions', {'sort' : 'DESC', 'orderby' : 'gamemode'})}}" title="">DESC</a>                        

                        <a href="{{path('app_competition_displaycompetitions', {'sort' : 'ASC', 'orderby' : 'typeofgame'})}}" title="">ASC</a>
                        <a href="{{path('app_competition_displaycompetitions', {'sort' : 'DESC', 'orderby' : 'typeofgame'})}}" title="">DESC</a>                        #}
    
    
{% endblock %}

{#    {{dump(competitions)}}
    {{dump(app.user)}}
    {{dump(app.request)}}
    {{dump(app.session)}}#}